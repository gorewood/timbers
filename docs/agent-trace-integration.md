# Agent Trace Integration Analysis

Analysis of [Agent Trace](https://agent-trace.dev) and its relationship to Timbers.

**Date:** 2026-01-30
**Status:** Research / Future Consideration

---

## What is Agent Trace?

Agent Trace is an open specification for documenting AI-generated code within version-controlled repositories. It answers the question: "Who wrote this code—human or AI?"

### Key Features

- **Line-level attribution**: Tracks which lines came from which contributor (human/ai/mixed/unknown)
- **Conversation references**: Links code to the AI conversation that generated it
- **Model identification**: Records which AI model (e.g., `anthropic/claude-opus-4-5-20251101`)
- **Content hashing**: Tracks code movement across files via hashes
- **VCS-agnostic**: Supports Git, Jujutsu, Mercurial, Subversion
- **Extensible metadata**: Vendor-specific fields via reverse-domain notation

### What It Explicitly Does NOT Address

From the spec:
- Legal ownership or copyright
- Training data analysis
- Quality evaluation
- Why code was written (rationale)

---

## Timbers vs Agent Trace: Comparison

| Aspect | Agent Trace | Timbers |
|--------|-------------|---------|
| Core question | "Who wrote this line?" | "Why was this change made?" |
| Granularity | Line-level | Commit-group (workset) |
| Primary data | Attribution (human/ai/mixed) | Rationale (what/why/how) |
| Storage | Flexible (files, notes, db) | Git notes |
| Links to | Conversation URLs, model IDs | Work items, tags |
| Target users | Compliance, auditing, tooling | Understanding, onboarding |

### Different Problems, Complementary Value

These specifications answer different questions about the same code:

```
6 months later, examining auth middleware:

Agent Trace: "Lines 45-67 were generated by claude-opus-4-5
             in conversation xyz, mixed with human edits"

Timbers:     "This middleware exists because handler-level auth
             was being bypassed on 3 routes"
```

Knowing code came from AI doesn't explain *why* it was written that way. Knowing the rationale doesn't reveal *who* wrote each line.

---

## Integration Opportunities

### 1. Timbers Entries Reference Agent Trace Data

When an agent logs work, it could record which files had AI contributions:

```json
{
  "summary": { "what": "...", "why": "...", "how": "..." },
  "workset": { "anchor_commit": "abc123", "commits": [...] },
  "trace": {
    "spec_version": "0.1",
    "files": [
      {
        "path": "internal/auth/middleware.go",
        "conversations": [{
          "url": "claude://session/abc123",
          "contributor": "ai",
          "model": "anthropic/claude-opus-4-5-20251101",
          "ranges": [{ "start": 45, "end": 67 }]
        }]
      }
    ]
  }
}
```

### 2. Agent Trace Conversations Link to Timbers Entries

The `related` URLs field in Agent Trace could point to Timbers entry IDs:

```json
{
  "conversations": [{
    "url": "claude://session/abc123",
    "related": [
      "timbers://tb_2026-01-30T10:00:00Z_abc123"
    ]
  }]
}
```

### 3. CLI Integration

```bash
# Log work and generate Agent Trace attribution
timbers log "Fixed auth bypass" --why "..." --how "..." --trace

# Query with attribution context
timbers query --last 5 --with-trace

# Export including Agent Trace data
timbers export --last 10 --include-trace
```

### 4. Combined Provenance Queries

A future tool could answer: "Show me all AI-generated code from the last sprint, with the rationale for each change."

---

## Recommendation

**Don't pivot—integrate.**

Timbers fills a gap Agent Trace explicitly doesn't address (the "why" reasoning layer). The two together provide comprehensive provenance:

- **Agent Trace**: Who wrote what, which model, which conversation
- **Timbers**: Why it was written, the reasoning, the context

### Next Steps (When Prioritized)

1. Review Agent Trace spec in detail: https://agent-trace.dev
2. Design optional `trace` field for entry schema
3. Implement `--trace` flag for `timbers log`
4. Consider reaching out to Agent Trace maintainers about complementary positioning

---

## References

- Agent Trace Spec: https://agent-trace.dev
- Agent Trace GitHub: (linked from spec site)
- Partners: Amp, Cloudflare, Cognition, Google Jules, OpenCode, Vercel
- License: CC BY 4.0
