{"schema":"timbers.devlog/v1","kind":"entry","id":"tb_2026-02-13T19:42:14Z_d0aee6","created_at":"2026-02-13T19:42:14.127421Z","updated_at":"2026-02-13T19:42:14.127421Z","workset":{"anchor_commit":"d0aee605d314154f8610f0c350d38e1f5533754d","commits":["d0aee605d314154f8610f0c350d38e1f5533754d"],"diffstat":{"files":3,"insertions":151,"deletions":87}},"summary":{"what":"Fix PostToolUse hook to read stdin instead of empty $TOOL_INPUT env var","why":"Claude Code hooks receive JSON on stdin, not env vars — $TOOL_INPUT was always empty, making the post-commit reminder a no-op since it was created","how":"grep reads stdin directly instead of printf piping $TOOL_INPUT; added legacy detection and upgrade logic so reinstall replaces stale hooks; extracted JSON parsing into claude_parse.go for file-length lint"},"notes":"Discovered via GitHub issue #9567 confirming TOOL_INPUT is always empty. Considered jq-based JSON parsing of stdin to extract tool_input.command specifically, but grepping the full JSON blob for 'git commit' is simpler, needs no dependencies, and false positive risk is negligible. Upgrade logic uses hasExactHookCommand to detect current vs stale, then removeTimbersHooksFromEvent to clean before re-adding — avoids the old skip-if-any-exists behavior that left broken hooks in place forever."}